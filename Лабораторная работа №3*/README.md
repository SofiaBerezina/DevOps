# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3*: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –≤ CI/CD

## ‚úçüèª –û–ø–∏—Å–∞–Ω–∏–µ

–í —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º —Å–µ–∫—Ä–µ—Ç–æ–≤ HashiCorp Vault. –ü–∞–π–ø–ª–∞–π–Ω –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –±–µ–∑ –∏—Ö —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –≤ –ª–æ–≥–∞—Ö. –¢–∞–∫–∂–µ –º—ã —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, –ø–æ—á–µ–º—É —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
### üóìÔ∏è –ó–∞–¥–∞—á–∏:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HashiCorp Vault
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å ngrok
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Actions
4. –û–±–æ—Å–Ω–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã

## üìù –ó–∞–¥–∞–Ω–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π:
–°–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤–æ —Ä–∞–±–æ—Ç—É —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–Ω—è—Ç—å Hashicorp Vault (–∏–ª–∏ –¥—Ä—É–≥—É—é —Å–µ–∫—Ä–µ—Ç–æ—Ö—Ä–∞–Ω–∏–ª–∫—É) –∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã ci/cd –ø–∞–π–ø–ª–∞–π–Ω (–∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –≤–∞—à —Å–µ—Ä–≤–∏—Å) —Ö–æ–¥–∏–ª —Ç—É–¥–∞, –±—Ä–∞–ª —Å–µ–∫—Ä–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –µ–≥–æ –Ω–µ —Å–≤–µ—Ç—è –≤ –ª–æ–≥–∞—Ö. –í Readme –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á–µ–º—É –≤–∞—à —Å–ø–æ—Å–æ–± –∫—Ä–∞—Å–∏–≤—ã–π, –∞ —Ç–∞–∫–∂–µ –æ–ø–∏—Å–∞—Ç—å, –ø–æ—á–µ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ CI/CD –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π.
## üéõÔ∏è –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HashiCorp Vault –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. 
> HashiCorp Vault ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–ª—é—á–∏ API, —Ç–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–∞—Ä–æ–ª–∏. –û–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–ª–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü–æ—Å–∫–æ–ª—å–∫—É –¥–æ—Å—Ç—É–ø –∫ –∏—Ö —Å–∞–π—Ç—É —Ç–æ–ª—å–∫–æ —Å VPN, —É–¥–æ–±–Ω–µ–µ –±—É–¥–µ—Ç —Å–∫–∞—á–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ [–Ω–µ–≥–æ](http://c-releases.hashicorp.com/vault/1.18.2/), –∞ –Ω–µ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª. –í—ã–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –∏ –ø–æ–¥–±–∏—Ä–∞–µ–º –ø–æ–¥ —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∞ Darwin arm64):

![ph1](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2019.35.00.png)

–ó–∞—Ç–µ–º –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ —Å–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É bin –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ–º —Ç—É–¥–∞ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª vault –∏–∑ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞:

![ph2](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2019.36.52.png)

–ò —á—Ç–æ–±—ã —Ñ–∞–π–ª –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–ø–∫—É bin –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è PATH. –î–ª—è —ç—Ç–æ–≥–æ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:
```bash
nano ~/.zshrc
```
–ò –¥–æ–±–∞–≤–ª—è–µ–º —Ç—É–¥–∞ —Å—Ç—Ä–æ–∫—É:
```bash
export PATH="$HOME/bin:$PATH"
```
–ü–æ–ª—É—á–∏—Ç—Å—è —Ç–∞–∫:

![ph3](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2019.58.47.png)

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–º–∞–Ω–¥–æ–π:
```bash
vault ‚Äìversion
```
–ï—Å–ª–∏ –≤—Å–µ —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ç–æ –Ω–∞ —ç–∫—Ä–∞–Ω –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∞ —Å–∫–∞—á–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Vault:

![ph4](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2019.59.28.png)

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å Vault. –î–µ–ª–∞—Ç—å —ç—Ç–æ –ª—É—á—à–µ –≤ dev-—Ä–µ–∂–∏–º–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –î–ª—è —ç—Ç–æ–≥–æ –≤–≤–æ–¥–∏–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª –∫–æ–º–∞–Ω–¥—É:
```bash
vault server -dev
```
–ü–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ dev-–≤–µ—Ä—Å–∏–∏ Vault. –í –Ω–µ–º –±—É–¥—É—Ç –¥–≤–µ –≤–∞–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏: ```Root Token``` –∏ ```API URL```. –ò—Ö –Ω—É–∂–Ω–æ –≤—ã–ø–∏—Å–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º:

![ph5](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2020.01.15.png)

–ù—É–∂–Ω—ã–µ –Ω–∞–º –¥–∞–Ω–Ω—ã–µ:

![ph6](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2020.04.18.png)

–ó–∞—Ç–µ–º —É–∂–µ –≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∞–¥—Ä–µ—Å Vault –∏ Root Token:
```bash
export VAULT_ADDR='http://127.0.0.1:8200'
export VAULT_TOKEN='<hvs.s5tyg60krte2smg04r8fxykz'
```
–î–æ–±–∞–≤–ª—è–µ–º —Å–µ–∫—Ä–µ—Ç:
```bash
vault kv put secret/my-secret username="testuser" password="testpassword"
```
–ò –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–Ω —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω:
```bash
vault kv get secret/my-secret
```
![ph7](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2020.08.19.png)

## üì° –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ngrok
> ngrok ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –º–∞—à–∏–Ω—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –∑–∞–ø—É—â–µ–Ω, –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏, –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞, –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –ø–µ—Ä–µ–±—Ä–æ—à–µ–Ω—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –∏ –∑–∞–¥–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç.

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ngrok –∫–æ–º–∞–Ω–¥–æ–π:
```bash
brew install ngrok
```
–ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, –ø–æ—è–≤–∏—Ç—Å—è —Ç–∞–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

![ph8](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2021.49.42.png)

–ü–æ—Ç–æ–º –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å ngrok —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç Vault. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å—Ä–∞–∑—É, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –æ—à–∏–±–∫–∞üò±:

![ph9](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2021.55.38.png)


–ü–æ—ç—Ç–æ–º—É —Å VPN –Ω–∞–¥–æ –±—É–¥–µ—Ç –∑–∞–π—Ç–∏ –Ω–∞ [—Å–∞–π—Ç](https://dashboard.ngrok.com/signup) –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–ø–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
ngrok config add-authtoken
```
![ph10](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2021.58.09.png)

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞ 8200:
```bash
ngrok http 8200
```
Ngrok –≤—ã–¥–∞—Å—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL (—Å—Ç—Ä–æ–∫–∞ Forwarding), –µ–≥–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:

![ph11](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2021.59.19.png)

## ‚å®Ô∏è –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions
–°–æ–∑–¥–∞–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub: https://github.com/Marinchanka/Secrets
–ò –¥–æ–±–∞–≤–ª—è–µ–º —Å–µ–∫—Ä–µ—Ç—ã. –î–ª—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º ```Settings => Secrets and variables => Actions``` –∏ –Ω–∞–∂–∏–º–∞–µ–º –Ω–∞ –∫–Ω–æ–ø–∫—É ```New repository secret```:

![ph12](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2022.06.15.png)

–î–æ–±–∞–≤–ª—è–µ–º –¥–≤–∞ —Å–µ–∫—Ä–µ—Ç–∞: 
*	```VAULT_ADDR``` - —ç—Ç–æ URL –∏–∑ ngrok, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏ –≤ –∫–æ–Ω—Ü–µ 2 –ø—É–Ω–∫—Ç–∞;
*	```VAULT_TOKEN``` - —ç—Ç–æ Root Token, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏ –≤ –Ω–∞—á–∞–ª–µ 1 –ø—É–Ω–∫—Ç–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Vault.

–ü–æ–ª—É—á–∏—Ç—Å—è —Ç–∞–∫:

![ph13](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2022.09.20.png)

–¢–µ–ø–µ—Ä—å –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É ```.github/workflows``` –∏ —Ñ–∞–π–ª ```main.yml```:

![ph14](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2022.17.55.png)

–£ –Ω–∞—Å –ø–æ–ª—É—á–∏–ª—Å—è —Ç–∞–∫–æ–π CI/CD —Ñ–∞–π–ª:
```yaml
name: Vault CI/CD

on:
  push:
    branches:
      - main

jobs:
  fetch-secrets:
    runs-on: macos-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Install Vault CLI
      run: |
        brew tap hashicorp/tap
        brew install hashicorp/tap/vault

    - name: Fetch secret from Vault
      env:
        VAULT_ADDR: ${{ secrets.VAULT_ADDR }}
        VAULT_TOKEN: ${{ secrets.VAULT_TOKEN }}
      run: |
        echo "Fetching secret from Vault..."
        export VAULT_ADDR=${{ secrets.VAULT_ADDR }}
        export VAULT_TOKEN=${{ secrets.VAULT_TOKEN }}
        
        if ! vault kv get -field=username secret/my-secret; then
          echo "Failed to fetch secret."
          exit 1 
        fi
        echo "Secret fetched successfully." 
```

–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Ñ–∞–π–ª–∞:
* **on**: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –ø–∞–π–ø–ª–∞–π–Ω –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø—Ä–∏ push –≤ –≤–µ—Ç–∫—É main;
* **runs-on**: macos-latest: —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–µ–π macOS;
* **env**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∞–¥—Ä–µ—Å–∞ Vault (VAULT_ADDR) –∏ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–∞ (VAULT_TOKEN). –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ GitHub Secrets, —á—Ç–æ–±—ã –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ;
* **run**: –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Vault –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã vault kv get;
* –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ Vault –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "Failed to fetch secret.", –∏ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π (exit 1);
* –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç –ø–æ–ª—É—á–µ–Ω —É—Å–ø–µ—à–Ω–æ, –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "Secret fetched successfully.".

–ö–æ–º–º–∏—Ç–∏–º —Ñ–∞–π–ª –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≥–∞–ª–æ—á–∫–∞ —Å –Ω–∞–¥–ø–∏—Å—å—é successful, –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª Actions –Ω–∞ GitHub –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´Secret fetched successfully.¬ª –∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–µ–∫—Ä–µ—Ç–æ–≤!

![ph15](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2022.31.19.png)

![ph16](https://github.com/SofiaBerezina/DevOps/blob/main/–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è%20—Ä–∞–±–æ—Ç–∞%20‚Ññ3*/images/–°–Ω–∏–º–æ–∫%20—ç–∫—Ä–∞–Ω–∞%202024-11-29%20–≤%2023.41.15.png)

–í—Å–µ —Å–¥–µ–ª–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ!

### üîí–ü–æ—á–µ–º—É –Ω–∞—à —Å–ø–æ—Å–æ–± –∫—Ä–∞—Å–∏–≤—ã–π?
- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω–µ—à–Ω–µ, –∞ –Ω–µ –≤–Ω—É—Ç—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –í –ø–∞–π–ø–ª–∞–π–Ω–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –ª–æ–≥–∏ –∏ –Ω–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –±–æ–ª–µ–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GitHub Secrets –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Vault —Ç–∞–∫–∂–µ —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç, –µ–≥–æ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤ Vault, –∏ –≤—Å–µ —Å–∏—Å—Ç–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –µ–≥–æ, –ø–æ–ª—É—á–∞—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –∫–∞–∂–¥–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### ‚ùì–ü–æ—á–µ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ CI/CD –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Äî –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞?
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –∏—Ö –æ—Ç —É—Ç–µ—á–µ–∫. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é, –æ–Ω —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å–µ–∫—Ä–µ—Ç–∞–º, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CI/CD
- –¢–∞–∫–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ –ª–æ–≥–∏ –∏–ª–∏ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã, —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —É–≥—Ä–æ–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–≥–¥–∞ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –ø—Ä—è–º–æ –≤ CI/CD –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –æ–Ω–∏ —Ä–∞—Å–ø–æ–ª–∑–∞—é—Ç—Å—è –ø–æ —Ä–∞–∑–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º –∏ —Å–µ—Ä–≤–∏—Å–∞–º. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π –∏ –¥–µ–ª–∞–µ—Ç –µ–µ –º–µ–Ω–µ–µ –≥–∏–±–∫–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç, –µ–≥–æ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –∫–∞–∂–¥–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —á—Ç–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ

## üë©üèª‚Äçü§ù‚Äçüë©üèº –ê–≤—Ç–æ—Ä—ã
- –ú–∞—à–∫–æ–≤—Ü–µ–≤–∞ –ú–∞—Ä–∏–Ω–∞ –ê–ª–µ–∫—Å–µ–µ–≤–Ω–∞
- –ë–µ—Ä–µ–∑–∏–Ω–∞ –°–æ—Ñ—å—è –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–≤–Ω–∞
